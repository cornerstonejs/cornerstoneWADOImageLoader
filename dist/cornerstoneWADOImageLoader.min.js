/*! cornerstone-wado-image-loader - 0.14.6 - 2017-08-31 | (c) 2016 Chris Hafey | https://github.com/chafey/cornerstoneWADOImageLoader */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("jquery"),require("cornerstone-core"),require("dicom-parser")):"function"==typeof define&&define.amd?define("cornerstoneWADOImageLoader",["jquery","cornerstone-core","dicom-parser"],t):"object"==typeof exports?exports.cornerstoneWADOImageLoader=t(require("jquery"),require("cornerstone-core"),require("dicom-parser")):e.cornerstoneWADOImageLoader=t(e.$,e.cornerstone,e.dicomParser)}(this,function(e,t,r){return function(e){function t(n){if(r[n])return r[n].exports;var a=r[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,t),a.l=!0,a.exports}var r={};return t.m=e,t.c=r,t.i=function(e){return e},t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=45)}([function(t,r){t.exports=e},function(e,r){e.exports=t},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.internal=t.xhrRequest=t.getOptions=t.setOptions=void 0;var n=r(46),a=function(e){return e&&e.__esModule?e:{default:e}}(n),o=r(8),u={xhrRequest:a.default,setOptions:o.setOptions,getOptions:o.getOptions};t.setOptions=o.setOptions,t.getOptions=o.getOptions,t.xhrRequest=a.default,t.internal=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default="0.14.6"},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments[2];return e&&e.Value?e.Value.length<=t?r:e.Value[t]:r}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.indexOf(":"),r=e.substring(t+1),n=r.indexOf("frame="),a=void 0;if(-1!==n){var o=r.substr(n+6);a=parseInt(o,10),r=r.substr(0,n-1)}return{scheme:e.substr(0,t),url:r,frame:a}}},function(e,t){e.exports=r},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){return"1.2.840.10008.5.1.4.1.1.12.1"!==e&&"1.2.840.10008.5.1.4.1.1.12.2.1"!==e}function o(e){16===e.bitsAllocated?0===e.pixelRepresentation?e.pixelData=new Uint16Array(e.pixelData):e.pixelData=new Int16Array(e.pixelData):e.pixelData=new Uint8Array(e.pixelData)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,r,n){var u=document.createElement("canvas"),l=i.default.Deferred(),f=(0,d.default)(e);return(0,s.default)(f,r,t,u,n).then(function(t){var n=h.metaData.get("imagePlaneModule",e)||{},i=h.metaData.get("voiLutModule",e)||{},d=h.metaData.get("modalityLutModule",e)||{},f=h.metaData.get("sopCommonModule",e)||{},s=(0,p.default)(t.photometricInterpretation);if(!(0,y.default)(t,r)&&(o(t),s)){u.height=t.rows,u.width=t.columns;var c=u.getContext("2d"),g=c.createImageData(t.columns,t.rows);(0,m.default)(t,g),t.imageData=g,t.pixelData=g.data;var v=(0,b.default)(t.pixelData);t.smallestPixelValue=v.min,t.largestPixelValue=v.max}var P={imageId:e,color:s,columns:t.columns,rows:t.rows,width:t.columns,height:t.rows,intercept:d.rescaleIntercept||0,slope:d.rescaleSlope||1,invert:"MONOCHROME1"===t.photometricInterpretation,minPixelValue:t.smallestPixelValue,maxPixelValue:t.largestPixelValue,render:void 0,sizeInBytes:t.pixelData.length,rowPixelSpacing:n.pixelSpacing?n.pixelSpacing[0]:void 0,columnPixelSpacing:n.pixelSpacing?n.pixelSpacing[1]:void 0,windowCenter:i.windowCenter?i.windowCenter[0]:void 0,windowWidth:i.windowWidth?i.windowWidth[0]:void 0,decodeTimeInMS:t.decodeTimeInMS};if(P.getPixelData=function(){return t.pixelData},P.color?(P.render=h.renderColorImage,P.getCanvas=function(){return _===e?u:(u.height=P.rows,u.width=P.columns,u.getContext("2d").putImageData(t.imageData,0,0),_=e,u)}):P.render=h.renderGrayscaleImage,d.modalityLUTSequence&&d.modalityLUTSequence.length>0&&a(f.sopClassUID)&&(P.modalityLUT=d.modalityLUTSequence[0]),i.voiLUTSequence&&i.voiLUTSequence.length>0&&(P.voiLUT=i.voiLUTSequence[0]),void 0===P.windowCenter||void 0===P.windowWidth)if(P.color)P.windowWidth=255,P.windowCenter=128;else{var x=P.maxPixelValue*P.slope+P.intercept,w=P.minPixelValue*P.slope+P.intercept;P.windowWidth=x-w,P.windowCenter=(x+w)/2}l.resolve(P)}),l.promise()};var u=r(0),i=n(u),l=r(15),d=n(l),f=r(13),s=n(f),c=r(17),p=n(c),g=r(12),m=n(g),v=r(16),b=n(v),P=r(18),y=n(P),x=r(1),h=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(x),_=""},function(e,t,r){"use strict";function n(e){o=e}function a(){return o}Object.defineProperty(t,"__esModule",{value:!0}),t.setOptions=n,t.getOptions=a;var o={beforeSend:function(){},imageCreated:function(){},strict:!0}},function(e,t,r){"use strict";function n(e,t){i[e]=t}function a(e){return i[e]}function o(e){i[e]=void 0}function u(){i=[]}Object.defineProperty(t,"__esModule",{value:!0});var i=[];t.default={add:n,get:a,remove:o,purge:u}},function(e,t,r){"use strict";function n(e){return void 0!==p[e]}function a(e){if(!p[e])throw new Error("dataSetCacheManager.get: DataSet has not been loaded yet");return p[e].dataSet}function o(e,t,r){if(t=t||c.xhrRequest,p[e]){var n=d.default.Deferred();return p[e].cacheCount++,n.resolve(p[e].dataSet),n}if(g[e])return g[e];var a=t(e,r),o=d.default.Deferred();return a.then(function(t){var r=new Uint8Array(t),n=void 0;try{n=s.parseDicom(r)}catch(e){return void o.reject(e)}p[e]={dataSet:n,cacheCount:1},o.resolve(n),delete g[e]},function(e){o.reject(e)}).always(function(){delete g[e]}),g[e]=o,o}function u(e){p[e]&&0===--p[e].cacheCount&&delete p[e]}function i(){p={},g={}}Object.defineProperty(t,"__esModule",{value:!0});var l=r(0),d=function(e){return e&&e.__esModule?e:{default:e}}(l),f=r(6),s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(f),c=r(2),p={},g={};t.default={isLoaded:n,load:o,unload:u,purge:i,get:a}},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var a=r(41);Object.defineProperty(t,"convertRGBColorByPixel",{enumerable:!0,get:function(){return n(a).default}});var o=r(42);Object.defineProperty(t,"convertRGBColorByPlane",{enumerable:!0,get:function(){return n(o).default}});var u=r(43);Object.defineProperty(t,"convertYBRFullByPixel",{enumerable:!0,get:function(){return n(u).default}});var i=r(44);Object.defineProperty(t,"convertYBRFullByPlane",{enumerable:!0,get:function(){return n(i).default}});var l=r(40);Object.defineProperty(t,"convertPALETTECOLOR",{enumerable:!0,get:function(){return n(l).default}})},function(e,t,r){"use strict";function n(e,t){0===e.planarConfiguration?(0,u.convertRGBColorByPixel)(e.pixelData,t):(0,u.convertRGBColorByPlane)(e.pixelData,t)}function a(e,t){0===e.planarConfiguration?(0,u.convertYBRFullByPixel)(e.pixelData,t):(0,u.convertYBRFullByPlane)(e.pixelData,t)}function o(e,t){var r=t.data,o=e.photometricInterpretation;if("RGB"===o)n(e,r);else if("YBR_RCT"===o)n(e,r);else if("YBR_ICT"===o)n(e,r);else if("PALETTE COLOR"===o)(0,u.convertPALETTECOLOR)(e,r);else if("YBR_FULL_422"===o)n(e,r);else{if("YBR_FULL"!==o)throw new Error("No color space conversion for photometric interpretation "+o);a(e,r)}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=o;var u=r(11)},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e,t,r,n){var a=n.priority||void 0,o=n.transferPixelData?[r.buffer]:void 0;return i.default.addTask("decodeTask",{imageFrame:e,transferSyntax:t,pixelData:r,options:n},a,o).promise}function o(e,t,r,n,o){if(o=o||{},"1.2.840.10008.1.2"===t)return a(e,t,r,o);if("1.2.840.10008.1.2.1"===t)return a(e,t,r,o);if("1.2.840.10008.1.2.2"===t)return a(e,t,r,o);if("1.2.840.10008.1.2.1.99"===t)return a(e,t,r,o);if("1.2.840.10008.1.2.5"===t)return a(e,t,r,o);if("1.2.840.10008.1.2.4.50"===t)return 8!==e.bitsAllocated||3!==e.samplesPerPixel&&4!==e.samplesPerPixel?a(e,t,r,o):(0,d.default)(e,r,n);if("1.2.840.10008.1.2.4.51"===t)return a(e,t,r,o);if("1.2.840.10008.1.2.4.57"===t)return a(e,t,r,o);if("1.2.840.10008.1.2.4.70"===t)return a(e,t,r,o);if("1.2.840.10008.1.2.4.80"===t)return a(e,t,r,o);if("1.2.840.10008.1.2.4.81"===t)return a(e,t,r,o);if("1.2.840.10008.1.2.4.90"===t)return a(e,t,r,o);if("1.2.840.10008.1.2.4.91"===t)return a(e,t,r,o);throw new Error("No decoder for transfer syntax "+t)}Object.defineProperty(t,"__esModule",{value:!0});var u=r(19),i=n(u),l=r(14),d=n(l);t.default=o},function(e,t,r){"use strict";function n(e){return a(String.fromCharCode.apply(null,Array.prototype.slice.apply(new Uint8Array(e))))}function a(e){var t=void 0;try{return decodeURIComponent(escape(e))}catch(r){if((t=r)instanceof URIError)return e;throw t}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,r){var a=(new Date).getTime(),o=u.default.Deferred(),i=new Blob([t],{type:"image/jpeg"}),l=new FileReader;return void 0===l.readAsBinaryString?l.readAsArrayBuffer(i):l.readAsBinaryString(i),l.onload=function(){var t=new Image;t.onload=function(){r.height=t.height,r.width=t.width,e.rows=t.height,e.columns=t.width;var n=r.getContext("2d");n.drawImage(this,0,0);var u=n.getImageData(0,0,t.width,t.height),i=(new Date).getTime();e.pixelData=u.data,e.imageData=u,e.decodeTimeInMS=i-a,o.resolve(e)},t.onerror=function(e){o.reject(e)},void 0===l.readAsBinaryString?t.src="data:image/jpeg;base64,"+window.btoa(n(l.result)):t.src="data:image/jpeg;base64,"+window.btoa(l.result)},o.promise()};var o=r(0),u=function(e){return e&&e.__esModule?e:{default:e}}(o)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=a.metaData.get("imagePixelModule",e);return{samplesPerPixel:t.samplesPerPixel,photometricInterpretation:t.photometricInterpretation,planarConfiguration:t.planarConfiguration,rows:t.rows,columns:t.columns,bitsAllocated:t.bitsAllocated,pixelRepresentation:t.pixelRepresentation,smallestPixelValue:t.smallestPixelValue,largestPixelValue:t.largestPixelValue,redPaletteColorLookupTableDescriptor:t.redPaletteColorLookupTableDescriptor,greenPaletteColorLookupTableDescriptor:t.greenPaletteColorLookupTableDescriptor,bluePaletteColorLookupTableDescriptor:t.bluePaletteColorLookupTableDescriptor,redPaletteColorLookupTableData:t.redPaletteColorLookupTableData,greenPaletteColorLookupTableData:t.greenPaletteColorLookupTableData,bluePaletteColorLookupTableData:t.bluePaletteColorLookupTableData,pixelData:void 0}};var n=r(1),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(n)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){for(var t=e[0],r=e[0],n=e.length,a=0;a<n;a++){var o=e[a];t=Math.min(t,o),r=Math.max(r,o)}return{min:t,max:r}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return"RGB"===e||"PALETTE COLOR"===e||"YBR_FULL"===e||"YBR_FULL_422"===e||"YBR_PARTIAL_422"===e||"YBR_PARTIAL_420"===e||"YBR_RCT"===e||"YBR_ICT"===e}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return t=t||e.transferSyntax,8===e.bitsAllocated&&"1.2.840.10008.1.2.4.50"===t&&(3===e.samplesPerPixel||4===e.samplesPerPixel)}},function(e,t,r){"use strict";function n(){if(v.length){for(var e=0;e<b.length;e++)if("ready"===b[e].status){b[e].status="busy";var t=v.shift();t.start=(new Date).getTime();var r=(new Date).getTime();return h.totalTimeDelayedInMS+=r-t.added,b[e].task=t,b[e].worker.postMessage({taskType:t.taskType,workerIndex:e,data:t.data},t.transferList),void h.numTasksExecuting++}b.length<x.maxWebWorkers&&o()}}function a(e){if("initialize"===e.data.taskType)b[e.data.workerIndex].status="ready",n();else{var t=b[e.data.workerIndex].task.start;b[e.data.workerIndex].task.deferred.resolve(e.data.result),b[e.data.workerIndex].task=void 0,h.numTasksExecuting--,b[e.data.workerIndex].status="ready",h.numTasksCompleted++;var r=(new Date).getTime();h.totalTaskTimeInMS+=r-t,n()}}function o(){if(!(b.length>=x.maxWebWorkers)){var e=new Worker(x.webWorkerPath);b.push({worker:e,status:"initializing"}),e.addEventListener("message",a),e.postMessage({taskType:"initialize",workerIndex:b.length-1,config:x})}}function u(e){if(e=e||y,x)throw new Error("WebWorkerManager already initialized");if(x=e,x.maxWebWorkers=x.maxWebWorkers||navigator.hardwareConcurrency||1,!x.startWebWorkersOnDemand)for(var t=0;t<x.maxWebWorkers;t++)o()}function i(e,t){x.webWorkerTaskPaths.push(e),t&&(x.taskConfiguration=Object.assign(x.taskConfiguration,t));for(var r=0;r<b.length;r++)b[r].worker.postMessage({taskType:"loadWebWorkerTask",workerIndex:b.length-1,sourcePath:e,config:x})}function l(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments[3];x||u();var o=p.default.Deferred(),i=void 0;for(i=0;i<v.length&&!(v[i].priority<=r);i++);var l=m++;return v.splice(i,0,{taskId:l,taskType:e,status:"ready",added:(new Date).getTime(),data:t,deferred:o,priority:r,transferList:a}),n(),{taskId:l,promise:o.promise()}}function d(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=0;r<v.length;r++)if(v[r].taskId===e){var n=v.splice(r,1)[0];for(n.priority=t,r=0;r<v.length&&!(v[r].priority<=t);r++);return v.splice(r,0,n),!0}return!1}function f(e,t){for(var r=0;r<v.length;r++)if(v[r].taskId===e){var n=v.splice(r,1);return n.promise.reject(t),!0}return!1}function s(){return h.maxWebWorkers=x.maxWebWorkers,h.numWebWorkers=b.length,h.numTasksQueued=v.length,h}Object.defineProperty(t,"__esModule",{value:!0});var c=r(0),p=function(e){return e&&e.__esModule?e:{default:e}}(c),g=r(8),m=0,v=[],b=[],P=(0,g.getOptions)(),y={maxWebWorkers:navigator.hardwareConcurrency||1,startWebWorkersOnDemand:!0,webWorkerPath:"../../dist/cornerstoneWADOImageLoaderWebWorker.js",webWorkerTaskPaths:[],taskConfiguration:{decodeTask:{loadCodecsOnStartup:!0,initializeCodecsOnStartup:!1,codecsPath:"../dist/cornerstoneWADOImageLoaderCodecs.js",usePDFJS:!1,strict:P.strict}}},x=void 0,h={maxWebWorkers:0,numWebWorkers:0,numTasksQueued:0,numTasksExecuting:0,numTasksCompleted:0,totalTaskTimeInMS:0,totalTimeDelayedInMS:0};t.default={initialize:u,loadWebWorkerTask:i,addTask:l,getStatistics:s,setTaskPriority:d,cancelTask:f}},function(e,t,r){"use strict";function n(e,t,r){if(r+e.length>t.length)return!1;for(var n=r,a=0;a<e.length;a++)if(e[a]!==t[n++])return!1;return!0}function a(e,t,r){r=r||0;for(var a=(0,u.default)(t),o=r;o<e.length;o++)if(a[0]===e[o]&&n(a,e,o))return o;return-1}Object.defineProperty(t,"__esModule",{value:!0}),t.default=a;var o=r(51),u=function(e){return e&&e.__esModule?e:{default:e}}(o)},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){for(var t=0;t<e.length;t++)if("--"===e[t].substr(0,2))return e[t]}function o(e){for(var t=0;t<e.length;t++)if("Content-Type:"===e[t].substr(0,13))return e[t].substr(13).trim()}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,r){r=r||"application/octet-stream";var n={accept:r},u=i.default.Deferred();return(0,l.xhrRequest)(e,t,n).then(function(e){var t=new Uint8Array(e),r=(0,f.default)(t,"\r\n\r\n");-1===r&&u.reject("invalid response - no multipart mime header");var n=(0,c.default)(t,0,r),i=n.split("\r\n"),l=a(i);l||u.reject("invalid response - no boundary marker");var d=r+4,s=(0,f.default)(t,l,d);-1===s&&u.reject("invalid response - terminating boundary not found");var p=s-d-2;u.resolve({contentType:o(i),imageFrame:{pixelData:new Uint8Array(e,d,p)}})}),u.promise()};var u=r(0),i=n(u),l=r(2),d=r(20),f=n(d),s=r(52),c=n(s)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var r=(0,a.default)(e,t);if(void 0!==r)return parseFloat(r)};var n=r(4),a=function(e){return e&&e.__esModule?e:{default:e}}(n)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(e&&e.Value&&!(t&&e.Value.length<t)){for(var r=[],n=0;n<e.Value.length;n++)r.push(parseFloat(e.Value[n]));return r}}},function(e,t,r){"use strict";function n(e){return"dicomfile:"+(i.push(e)-1)}function a(e){return i[e]}function o(e){i[e]=void 0}function u(){i=[]}Object.defineProperty(t,"__esModule",{value:!0});var i=[];t.default={add:n,get:a,remove:o,purge:u}},function(e,t,r){"use strict";function n(e){return e.intString("x00280008")!==e.elements.x7fe00010.fragments.length}function a(e,t){if(e.elements.x7fe00010.basicOffsetTable.length)return u.readEncapsulatedImageFrame(e,e.elements.x7fe00010,t);if(n(e)){var r=u.createJPEGBasicOffsetTable(e,e.elements.x7fe00010);return u.readEncapsulatedImageFrame(e,e.elements.x7fe00010,t,r)}return u.readEncapsulatedPixelDataFromFragments(e,e.elements.x7fe00010,t)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=a;var o=r(6),u=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(o)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var r=e.elements.x7fe00010,n=e.uint16("x00280100"),o=e.uint16("x00280010"),u=e.uint16("x00280011"),i=e.uint16("x00280002"),l=r.dataOffset,d=o*u*i,f=void 0;if(8===n){if((f=l+t*d)>=e.byteArray.length)throw new Error("frame exceeds size of pixelData");return new Uint8Array(e.byteArray.buffer,f,d)}if(16===n){if((f=l+t*d*2)>=e.byteArray.length)throw new Error("frame exceeds size of pixelData");return new Uint8Array(e.byteArray.buffer,f,2*d)}if(1===n){if((f=l+t*d*.125)>=e.byteArray.length)throw new Error("frame exceeds size of pixelData");return(0,a.default)(e.byteArray,f,d)}throw new Error("unsupported pixel format")};var n=r(32),a=function(e){return e&&e.__esModule?e:{default:e}}(n)},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=(0,i.default)(e),r=parseInt(t.url,10),n=d.default.get(r),a=o.default.Deferred(),u=new FileReader;return u.onload=function(e){var t=e.target.result;a.resolve(t)},u.readAsArrayBuffer(n),a.promise()};var a=r(0),o=n(a),u=r(5),i=n(u),l=r(24),d=n(l)},function(e,t,r){"use strict";function n(e,t){if(e.elements[t]&&6===e.elements[t].length)return[e.uint16(t,0),e.uint16(t,1),e.uint16(t,2)]}function a(e,t,r){for(var n=[],a=e.elements[t],o=r[0],u=0;u<o;u++)16===r[2]?n[u]=e.uint16(t,u):n[u]=e.byteArray[u+a.dataOffset];return n}function o(e,t){"PALETTE COLOR"===t.photometricInterpretation&&e.elements.x00281101&&(t.redPaletteColorLookupTableDescriptor=n(e,"x00281101"),t.greenPaletteColorLookupTableDescriptor=n(e,"x00281102"),t.bluePaletteColorLookupTableDescriptor=n(e,"x00281103"),t.redPaletteColorLookupTableData=a(e,"x00281201",t.redPaletteColorLookupTableDescriptor),t.greenPaletteColorLookupTableData=a(e,"x00281202",t.greenPaletteColorLookupTableDescriptor),t.bluePaletteColorLookupTableData=a(e,"x00281203",t.bluePaletteColorLookupTableDescriptor))}function u(e,t){0===e.uint16("x00280103")?(t.smallestPixelValue=e.uint16("x00280106"),t.largestPixelValue=e.uint16("x00280107")):(t.smallestPixelValue=e.int16("x00280106"),t.largestPixelValue=e.int16("x00280107"))}function i(e){var t={samplesPerPixel:e.uint16("x00280002"),photometricInterpretation:e.string("x00280004"),rows:e.uint16("x00280010"),columns:e.uint16("x00280011"),bitsAllocated:e.uint16("x00280100"),bitsStored:e.uint16("x00280101"),highBit:e.uint16("x00280102"),pixelRepresentation:e.uint16("x00280103"),planarConfiguration:e.uint16("x00280006"),pixelAspectRatio:e.string("x00280034")};return u(e,t),o(e,t),t}Object.defineProperty(t,"__esModule",{value:!0}),t.default=i},function(e,t,r){"use strict";function n(e,t){var r=t.uint16("x00283002",0);0===r&&(r=65535);var n=0;n=0===e?t.uint16("x00283002",1):t.int16("x00283002",1);for(var a=t.uint16("x00283002",2),o={id:"1",firstValueMapped:n,numBitsPerEntry:a,lut:[]},u=0;u<r;u++)o.lut[u]=0===e?t.uint16("x00283006",u):t.int16("x00283006",u);return o}function a(e,t){if(t&&t.items.length){for(var r=[],a=0;a<t.items.length;a++){var o=t.items[a].dataSet,u=n(e,o);u&&r.push(u)}return r}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=a},function(e,t,r){"use strict";function n(e){var t=e.uint16("x00280103"),r=e.uint16("x00280101");return 0===t?0:-1<<r-1}function a(e){var t=e.string("x00080016");if("1.2.840.10008.5.1.4.1.1.2"===t||"1.2.840.10008.5.1.4.1.1.2.1"===t)return 1;var r=e.floatString("x00281052"),a=e.floatString("x00281053");if(void 0!==r&&void 0!==a){return n(e)*a+r<0?1:0}return e.elements.x00283000&&e.elements.x00283000.length>0?0:e.uint16("x00280103")}Object.defineProperty(t,"__esModule",{value:!0}),t.default=a},function(e,t,r){"use strict";function n(e,t,r){var n=[],a=e.string(t);if(a){var o=a.split("\\");if(!(r&&o.length<r)){for(var u=0;u<o.length;u++)n.push(parseFloat(o[u]));return n}}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=n},function(e,t,r){"use strict";function n(e,t){return Boolean(e&1<<t)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,r){for(var a=new Uint8Array(r),o=0;o<r;o++){var u=Math.floor(o/8),i=e[u+t],l=o%8;a[o]=n(i,l)?1:0}return a}},,,function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){(0,n.setOptions)(e)};var n=r(2)},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var a=r(49),o=r(20),u=n(o),i=r(21),l=n(i),d=r(9),f=n(d),s=r(47),c=n(s),p={getNumberString:a.getNumberString,getNumberValue:a.getNumberValue,getNumberValues:a.getNumberValues,getValue:a.getValue,metaDataProvider:a.metaDataProvider};t.default={metaData:p,findIndexOfString:u.default,getPixelData:l.default,loadImage:c.default,metaDataManager:f.default}},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var a=r(54),o=r(10),u=n(o),i=r(24),l=n(i),d=r(25),f=n(d),s=r(26),c=n(s),p=r(27),g=n(p),m=r(53),v=r(5),b=n(v),P=r(32),y=n(P),x={getImagePixelModule:a.getImagePixelModule,getLUTs:a.getLUTs,getModalityLUTOutputPixelRepresentation:a.getModalityLUTOutputPixelRepresentation,getNumberValues:a.getNumberValues,metaDataProvider:a.metaDataProvider};t.default={metaData:x,dataSetCacheManager:u.default,fileManager:l.default,getEncapsulatedImageFrame:f.default,getUncompressedImageFrame:c.default,loadFileRequest:g.default,loadImageFromPromise:m.loadImageFromPromise,getLoaderForScheme:m.getLoaderForScheme,loadImage:m.loadImage,parseImageId:b.default,unpackBinaryFrame:y.default}},,,function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var r=e.columns*e.rows,n=0,a=0,o=e.pixelData,u=e.redPaletteColorLookupTableDescriptor[1],i=e.redPaletteColorLookupTableData,l=e.greenPaletteColorLookupTableData,d=e.bluePaletteColorLookupTableData,f=8===e.redPaletteColorLookupTableDescriptor[2]?0:8,s=e.redPaletteColorLookupTableData.length;0===s&&(s=65535);for(var c=0;c<r;++c){var p=o[n++];p<u?p=0:p>u+s-1?p=s-1:p-=u,t[a++]=i[p]>>f,t[a++]=l[p]>>f,t[a++]=d[p]>>f,t[a++]=255}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(void 0===e)throw new Error("decodeRGB: rgbBuffer must not be undefined");if(e.length%3!=0)throw new Error("decodeRGB: rgbBuffer length must be divisible by 3");for(var r=e.length/3,n=0,a=0,o=0;o<r;o++)t[a++]=e[n++],t[a++]=e[n++],t[a++]=e[n++],t[a++]=255}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(void 0===e)throw new Error("decodeRGB: rgbBuffer must not be undefined");if(e.length%3!=0)throw new Error("decodeRGB: rgbBuffer length must be divisible by 3");for(var r=e.length/3,n=0,a=0,o=r,u=2*r,i=0;i<r;i++)t[n++]=e[a++],t[n++]=e[o++],t[n++]=e[u++],t[n++]=255}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(void 0===e)throw new Error("decodeRGB: ybrBuffer must not be undefined");if(e.length%3!=0)throw new Error("decodeRGB: ybrBuffer length must be divisble by 3");for(var r=e.length/3,n=0,a=0,o=0;o<r;o++){var u=e[n++],i=e[n++],l=e[n++];t[a++]=u+1.402*(l-128),t[a++]=u-.34414*(i-128)-.71414*(l-128),t[a++]=u+1.772*(i-128),t[a++]=255}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(void 0===e)throw new Error("decodeRGB: ybrBuffer must not be undefined");if(e.length%3!=0)throw new Error("decodeRGB: ybrBuffer length must be divisble by 3");for(var r=e.length/3,n=0,a=0,o=r,u=2*r,i=0;i<r;i++){var l=e[a++],d=e[o++],f=e[u++];t[n++]=l+1.402*(f-128),t[n++]=l-.34414*(d-128)-.71414*(f-128),t[n++]=l+1.772*(d-128),t[n++]=255}}},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var a=r(11);Object.keys(a).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return a[e]}})});var o=r(37);Object.defineProperty(t,"wadouri",{enumerable:!0,get:function(){return n(o).default}});var u=r(36);Object.defineProperty(t,"wadors",{enumerable:!0,get:function(){return n(u).default}});var i=r(35);Object.defineProperty(t,"configure",{enumerable:!0,get:function(){return n(i).default}});var l=r(12);Object.defineProperty(t,"convertColorSpace",{enumerable:!0,get:function(){return n(l).default}});var d=r(7);Object.defineProperty(t,"createImage",{enumerable:!0,get:function(){return n(d).default}});var f=r(13);Object.defineProperty(t,"decodeImageFrame",{enumerable:!0,get:function(){return n(f).default}});var s=r(14);Object.defineProperty(t,"decodeJPEGBaseline8BitColor",{enumerable:!0,get:function(){return n(s).default}});var c=r(15);Object.defineProperty(t,"getImageFrame",{enumerable:!0,get:function(){return n(c).default}});var p=r(16);Object.defineProperty(t,"getMinMax",{enumerable:!0,get:function(){return n(p).default}});var g=r(17);Object.defineProperty(t,"isColorImage",{enumerable:!0,get:function(){return n(g).default}});var m=r(18);Object.defineProperty(t,"isJPEGBaseline8BitColor",{enumerable:!0,get:function(){return n(m).default}});var v=r(19);Object.defineProperty(t,"webWorkerManager",{enumerable:!0,get:function(){return n(v).default}});var b=r(3);Object.defineProperty(t,"version",{enumerable:!0,get:function(){return n(b).default}});var P=r(2);Object.defineProperty(t,"internal",{enumerable:!0,get:function(){return P.internal}})},function(e,t,r){"use strict";function n(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=o.default.Deferred(),a=(0,u.getOptions)(),i=new XMLHttpRequest;return i.open("get",e,!0),i.responseType="arraybuffer",a.beforeSend(i),Object.keys(r).forEach(function(e){i.setRequestHeader(e,r[e])}),i.onreadystatechange=function(){4===i.readyState&&(200===i.status?n.resolve(i.response,i):n.reject(i))},i.onprogress=function(e){if(e.lengthComputable){var r=e.loaded,n=e.total,a=Math.round(r/n*100);(0,o.default)(l.events).trigger("CornerstoneImageLoadProgress",{imageId:t,loaded:r,total:n,percentComplete:a})}},i.send(),n.promise()}Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),o=function(e){return e&&e.__esModule?e:{default:e}}(a),u=r(8),i=r(1),l=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(i);t.default=n},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(){return"1.2.840.10008.1.2"}function o(e,t){var r=(new Date).getTime(),n=i.default.Deferred(),o=e.substring(7);if(void 0===s.default.get(e))return n.reject("no metadata for imageId "+e),n.promise();return(0,p.default)(o,e,'multipart/related; type="application/octet-stream"').then(function(o){var u=a(o.contentType),i=o.imageFrame.pixelData;(0,m.default)(e,i,u,t).then(function(e){var t=(new Date).getTime();e.loadTimeInMS=t-r,n.resolve(e)})}).fail(function(e){n.reject(e)}),n}Object.defineProperty(t,"__esModule",{value:!0}),t.default=o;var u=r(0),i=n(u),l=r(1),d=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(l),f=r(9),s=n(f),c=r(21),p=n(c),g=r(7),m=n(g);d.registerImageLoader("wadors",o)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,r){var n=(0,a.default)(e,t,r);if(void 0!==n)return parseFloat(n)};var n=r(4),a=function(e){return e&&e.__esModule?e:{default:e}}(n)},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var a=r(48);Object.defineProperty(t,"getNumberString",{enumerable:!0,get:function(){return n(a).default}});var o=r(22);Object.defineProperty(t,"getNumberValue",{enumerable:!0,get:function(){return n(o).default}});var u=r(23);Object.defineProperty(t,"getNumberValues",{enumerable:!0,get:function(){return n(u).default}});var i=r(4);Object.defineProperty(t,"getValue",{enumerable:!0,get:function(){return n(i).default}});var l=r(50);Object.defineProperty(t,"metaDataProvider",{enumerable:!0,get:function(){return n(l).default}})},function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function a(e){return e&&e.__esModule?e:{default:e}}function o(e,t){var r=p.default.get(t);if(r){if("generalSeriesModule"===e)return{modality:(0,d.default)(r["00080060"]),seriesInstanceUID:(0,d.default)(r["0020000e"]),seriesNumber:(0,s.default)(r["00200011"]),studyInstanceUID:(0,d.default)(r["0020000d"]),seriesDate:m.parseDA((0,d.default)(r["00080021"])),seriesTime:m.parseTM((0,d.default)(r["00080031"],0,""))};if("patientStudyModule"===e)return{patientAge:(0,s.default)(r["00101010"]),patientSize:(0,s.default)(r["00101020"]),patientWeight:(0,s.default)(r["00101030"])};if("imagePlaneModule"===e)return{pixelSpacing:(0,i.default)(r["00280030"],2),imageOrientationPatient:(0,i.default)(r["00200037"],6),imagePositionPatient:(0,i.default)(r["00200032"],3),sliceThickness:(0,s.default)(r["00180050"]),sliceLocation:(0,s.default)(r["00201041"])};if("imagePixelModule"===e)return{samplesPerPixel:(0,s.default)(r["00280002"]),photometricInterpretation:(0,d.default)(r["00280004"]),rows:(0,s.default)(r["00280010"]),columns:(0,s.default)(r["00280011"]),bitsAllocated:(0,s.default)(r["00280100"]),bitsStored:(0,s.default)(r["00280101"]),highBit:(0,d.default)(r["00280102"]),pixelRepresentation:(0,s.default)(r["00280103"]),planarConfiguration:(0,s.default)(r["00280006"]),pixelAspectRatio:(0,d.default)(r["00280034"]),smallestPixelValue:(0,s.default)(r["00280106"]),largestPixelValue:(0,s.default)(r["00280107"]),redPaletteColorLookupTableDescriptor:(0,i.default)(r["00281101"]),greenPaletteColorLookupTableDescriptor:(0,i.default)(r["00281102"]),bluePaletteColorLookupTableDescriptor:(0,i.default)(r["00281103"]),redPaletteColorLookupTableData:(0,i.default)(r["00281201"]),greenPaletteColorLookupTableData:(0,i.default)(r["00281202"]),bluePaletteColorLookupTableData:(0,i.default)(r["00281203"])};if("voiLutModule"===e)return{windowCenter:(0,i.default)(r["00281050"],1),windowWidth:(0,i.default)(r["00281051"],1)};if("modalityLutModule"===e)return{rescaleIntercept:(0,s.default)(r["00281052"]),rescaleSlope:(0,s.default)(r["00281053"]),rescaleType:(0,d.default)(r["00281054"])};if("sopCommonModule"===e)return{sopClassUID:(0,d.default)(r["00080016"]),sopInstanceUID:(0,d.default)(r["00080018"])};if("petIsotopeModule"===e){var n=(0,d.default)(r["00540016"]);if(void 0===n)return;return{radiopharmaceuticalInfo:{radiopharmaceuticalStartTime:m.parseTM((0,d.default)(n["00181072"],0,"")),radionuclideTotalDose:(0,s.default)(n["00181074"]),radionuclideHalfLife:(0,s.default)(n["00181075"])}}}}}Object.defineProperty(t,"__esModule",{value:!0});var u=r(23),i=a(u),l=r(4),d=a(l),f=r(22),s=a(f),c=r(9),p=a(c),g=r(6),m=n(g);n(r(1)).metaData.addProvider(o),t.default=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){for(var t=new Uint8Array(e.length),r=0,n=e.length;r<n;r++)t[r]=e.charCodeAt(r);return t}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,r){t=t||0,r=r||e.length-t;for(var n="",a=t;a<t+r;a++)n+=String.fromCharCode(e[a]);return n}},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){e.decache=function(){var t=(0,v.default)(e.imageId);P.default.unload(t.url)}}function o(e,t){return e.elements.x7fe00010.encapsulatedPixelData?(0,x.default)(e,t):(0,_.default)(e,t)}function u(e,t,r,n){var u=(new Date).getTime();r=r||0;var i=f.default.Deferred();return e.then(function(e){var l=o(e,r),d=e.string("x00020010"),f=(new Date).getTime();(0,g.default)(t,l,d,n).then(function(t){t.data=e;var r=(new Date).getTime();t.loadTimeInMS=f-u,t.totalTimeInMS=r-u,a(t),i.resolve(t)})},function(e){i.reject(e)}),i}function i(e){return"dicomweb"===e||"wadouri"===e?M.xhrRequest:"dicomfile"===e?O.default:void 0}function l(e,t){var r=(0,v.default)(e),n=r.url,a=void 0;if(P.default.isLoaded(n))return a=P.default.get(n),u(a,e,r.frame,t);var o=i(r.scheme);return a=P.default.load(n,o,e),u(a,e,r.frame,t)}Object.defineProperty(t,"__esModule",{value:!0}),t.getLoaderForScheme=t.loadImageFromPromise=void 0;var d=r(0),f=n(d),s=r(1),c=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(s),p=r(7),g=n(p),m=r(5),v=n(m),b=r(10),P=n(b),y=r(25),x=n(y),h=r(26),_=n(h),w=r(27),O=n(w),M=r(2);c.registerImageLoader("dicomweb",l),c.registerImageLoader("wadouri",l),c.registerImageLoader("dicomfile",l),t.loadImageFromPromise=u,t.getLoaderForScheme=i,t.default=l},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var a=r(28);Object.defineProperty(t,"getImagePixelModule",{enumerable:!0,get:function(){return n(a).default}});var o=r(29);Object.defineProperty(t,"getLUTs",{enumerable:!0,get:function(){return n(o).default}});var u=r(30);Object.defineProperty(t,"getModalityLUTOutputPixelRepresentation",{enumerable:!0,get:function(){return n(u).default}});var i=r(31);Object.defineProperty(t,"getNumberValues",{enumerable:!0,get:function(){return n(i).default}});var l=r(55);Object.defineProperty(t,"metaDataProvider",{enumerable:!0,get:function(){return n(l).default}})},function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function a(e){return e&&e.__esModule?e:{default:e}}function o(e,t){var r=(0,d.default)(t);if(s.default.isLoaded(r.url)){var n=s.default.get(r.url);if("generalSeriesModule"===e)return{modality:n.string("x00080060"),seriesInstanceUID:n.string("x0020000e"),seriesNumber:n.intString("x00200011"),studyInstanceUID:n.string("x0020000d"),seriesDate:y.parseDA(n.string("x00080021")),seriesTime:y.parseTM(n.string("x00080031")||"")};if("patientStudyModule"===e)return{patientAge:n.intString("x00101010"),patientSize:n.floatString("x00101020"),patientWeight:n.floatString("x00101030")};if("imagePlaneModule"===e)return{pixelSpacing:(0,i.default)(n,"x00280030",2),imageOrientationPatient:(0,i.default)(n,"x00200037",6),imagePositionPatient:(0,i.default)(n,"x00200032",3),sliceThickness:n.floatString("x00180050"),sliceLocation:n.floatString("x00201041"),frameOfReferenceUID:n.string("x00200052")};if("imagePixelModule"===e)return(0,p.default)(n);if("modalityLutModule"===e)return{rescaleIntercept:n.floatString("x00281052"),rescaleSlope:n.floatString("x00281053"),rescaleType:n.string("x00281054"),modalityLUTSequence:(0,m.default)(n.uint16("x00280103"),n.elements.x00283000)};if("voiLutModule"===e){var a=(0,b.default)(n);return{windowCenter:(0,i.default)(n,"x00281050",1),windowWidth:(0,i.default)(n,"x00281051",1),voiLUTSequence:(0,m.default)(a,n.elements.x00283010)}}if("sopCommonModule"===e)return{sopClassUID:n.string("x00080016"),sopInstanceUID:n.string("x00080018")};if("petIsotopeModule"===e){var o=n.elements.x00540016;if(void 0===o)return;var u=o.items[0].dataSet;return{radiopharmaceuticalInfo:{radiopharmaceuticalStartTime:y.parseTM(u.string("x00181072")||""),radionuclideTotalDose:u.floatString("x00181074"),radionuclideHalfLife:u.floatString("x00181075")}}}}}Object.defineProperty(t,"__esModule",{value:!0});var u=r(31),i=a(u),l=r(5),d=a(l),f=r(10),s=a(f),c=r(28),p=a(c),g=r(29),m=a(g),v=r(30),b=a(v),P=r(6),y=n(P);n(r(1)).metaData.addProvider(o),t.default=o}])});
//# sourceMappingURL=cornerstoneWADOImageLoader.min.js.map